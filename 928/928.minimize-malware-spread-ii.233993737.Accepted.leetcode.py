class Solution:
    def minMalwareSpread(self, graph, initial):
        neighbours = {}
        for i, row in enumerate(graph):
            neighbours[i] = [j for j, val in enumerate(row) if val == 1 and j != i]

        def infected():
            for node in initial:
                connected(node)
            return len(visited)

        def connected(node):
            if node in visited:
                return
            visited.add(node)
            for nbor in neighbours[node]:
                connected(nbor)
        visited = set()
        initial_infected = infected()
        best_gain = 0
        best_node = None
        for removed in sorted(initial):
            visited = {removed}
            infected()
            gain = initial_infected - len(visited) + 1
            if gain > best_gain:
                best_gain = gain
                best_node = removed
        return best_node
